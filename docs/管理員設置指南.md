# MergeMeet 管理員設置指南

## 管理後台

```
http://localhost:5173/admin/login
```

---

## 創建管理員

### 方法一：註冊後提升權限（推薦）

```bash
# 1. 一般註冊
curl -X POST http://localhost:8000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@yourdomain.com","password":"SecurePass123!","date_of_birth":"1990-01-01"}'

# 2. 提升為管理員
docker exec mergemeet_postgres psql -U mergemeet -d mergemeet -c "
UPDATE users SET is_admin = true, email_verified = true WHERE email = 'admin@yourdomain.com';"
```

### 方法二：直接插入資料庫

```bash
# 1. 生成密碼哈希
cd backend && python3 -c "
import sys; sys.path.insert(0, '.')
from app.core.security import get_password_hash
print(get_password_hash('YourPassword123!'))"

# 2. 插入資料庫（替換 $HASH 為上面的輸出）
docker exec mergemeet_postgres psql -U mergemeet -d mergemeet -c "
INSERT INTO users (id, email, password_hash, date_of_birth, is_admin, email_verified, is_active)
VALUES (gen_random_uuid(), 'admin@yourdomain.com', '\$HASH', '1990-01-01', true, true, true);"
```

---

## 管理員登入

```bash
# API 登入（管理員專用端點）
curl -X POST http://localhost:8000/api/auth/admin-login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@mergemeet.com","password":"admin123"}'
```

**安全特性**: 5 次失敗後鎖定 15 分鐘

---

## 管理員 API

| 功能 | 端點 |
|------|------|
| 後台統計 | `GET /api/admin/stats` |
| 舉報列表 | `GET /api/admin/reports` |
| 審核舉報 | `POST /api/admin/reports/{id}/review` |
| 用戶列表 | `GET /api/admin/users` |
| 封禁用戶 | `POST /api/admin/users/ban` |
| 解禁用戶 | `POST /api/admin/users/unban` |
| 敏感詞列表 | `GET /api/moderation/sensitive-words` |
| 新增敏感詞 | `POST /api/moderation/sensitive-words` |
| 申訴列表 | `GET /api/moderation/appeals` |

---

## 常用指令

```bash
# 查看管理員列表
docker exec mergemeet_postgres psql -U mergemeet -d mergemeet -c "
SELECT email, is_active, created_at FROM users WHERE is_admin = true;"

# 重置密碼
cd backend && python3 -c "
import sys; sys.path.insert(0, '.')
from app.core.security import get_password_hash
print(get_password_hash('NewPassword123!'))"

docker exec mergemeet_postgres psql -U mergemeet -d mergemeet -c "
UPDATE users SET password_hash = '\$NEW_HASH' WHERE email = 'admin@mergemeet.com';"

# 撤銷管理員權限
docker exec mergemeet_postgres psql -U mergemeet -d mergemeet -c "
UPDATE users SET is_admin = false WHERE email = 'user@example.com';"
```

---

**最後更新**: 2025-12-25
